#!/bin/python3

import requests
import argparse

headers = {''}
def CVE_2019_17382_detection(target):
    detect_zabbix = "Zabbix"
    vuln_path = "/zabbix.php?action=dashboard.view&dashboardid=1"
    retrieve_zabbix = requests.get(target, headers=headers, timeout=5, verify=False).text
    if detect_zabbix in retrieve_zabbix:
        check_vuln = requests.get(target + "/zabbix" + vuln_path, headers=headers, timeout=5, verify=False).status_code
        if check_vuln == 200:
            print(f"{target}{vuln_path} is vulnerable to CVE-2019-17382")

def CVE_2019_17382_scanner(target_file):
    with open(target_file, 'r') as targ:
        for targs in targ:
            targets = targs.split()
